VERSION 5.00
Begin VB.UserControl ctlVHome 
   BackColor       =   &H00E0EEEE&
   ClientHeight    =   6480
   ClientLeft      =   0
   ClientTop       =   0
   ClientWidth     =   8340
   ScaleHeight     =   6480
   ScaleMode       =   0  '’∞ªﬁ∞
   ScaleWidth      =   8340
   Begin Umakichi.ctlClickLabel clblCmd 
      Height          =   225
      Index           =   0
      Left            =   570
      TabIndex        =   6
      ToolTipText     =   "èoînï\ÇëIëÅAï\é¶ÇµÇ‹Ç∑ÅB"
      Top             =   1500
      Width           =   675
      _ExtentX        =   1191
      _ExtentY        =   397
      AutoSize        =   -1  'True
      BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "ÇlÇr ÇoÉSÉVÉbÉN"
         Size            =   11.25
         Charset         =   128
         Weight          =   400
         Underline       =   -1  'True
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   16711680
      Key             =   "Empty"
      ViewerName      =   "RAKaiSel"
      Caption         =   "èoînï\"
   End
   Begin VB.Frame fraSub 
      BackColor       =   &H00C0CCCC&
      BorderStyle     =   0  'Ç»Çµ
      Caption         =   "Frame1"
      Height          =   345
      Index           =   1
      Left            =   300
      TabIndex        =   4
      Top             =   2640
      Width           =   6915
      Begin VB.Label lblFix 
         AutoSize        =   -1  'True
         BackColor       =   &H00C0CCCC&
         Caption         =   "É}ÉXÉ^Å[èÓïÒ"
         BeginProperty Font 
            Name            =   "ÇlÇr ÇoÉSÉVÉbÉN"
            Size            =   11.25
            Charset         =   128
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   225
         Index           =   2
         Left            =   180
         TabIndex        =   5
         Top             =   60
         Width           =   1245
      End
   End
   Begin VB.Frame fraSub 
      BackColor       =   &H00C0CCCC&
      BorderStyle     =   0  'Ç»Çµ
      Caption         =   "Frame1"
      Height          =   345
      Index           =   0
      Left            =   330
      TabIndex        =   2
      Top             =   990
      Width           =   6195
      Begin VB.Label lblFix 
         AutoSize        =   -1  'True
         BackColor       =   &H00C0CCCC&
         Caption         =   "ÉåÅ[ÉXèÓïÒ"
         BeginProperty Font 
            Name            =   "ÇlÇr ÇoÉSÉVÉbÉN"
            Size            =   11.25
            Charset         =   128
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   225
         Index           =   1
         Left            =   180
         TabIndex        =   3
         Top             =   60
         Width           =   1065
      End
   End
   Begin VB.Frame fraTop 
      BackColor       =   &H00C0CCCC&
      BorderStyle     =   0  'Ç»Çµ
      Caption         =   "Frame1"
      Height          =   465
      Left            =   120
      TabIndex        =   0
      Top             =   180
      Width           =   7800
      Begin VB.Label lblFix 
         AutoSize        =   -1  'True
         BackColor       =   &H00C0CCCC&
         Caption         =   "ëççáÉÅÉjÉÖÅ["
         BeginProperty Font 
            Name            =   "ÇlÇr ÇoÉSÉVÉbÉN"
            Size            =   18
            Charset         =   128
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   360
         Index           =   0
         Left            =   270
         TabIndex        =   1
         Top             =   60
         Width           =   1950
      End
   End
   Begin Umakichi.ctlClickLabel clblCmd 
      Height          =   225
      Index           =   1
      Left            =   570
      TabIndex        =   7
      Top             =   1860
      Width           =   1125
      _ExtentX        =   1984
      _ExtentY        =   397
      AutoSize        =   -1  'True
      BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "ÇlÇr ÇoÉSÉVÉbÉN"
         Size            =   11.25
         Charset         =   128
         Weight          =   400
         Underline       =   -1  'True
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   16711680
      Key             =   "Empty"
      ViewerName      =   "TKKaiSel"
      Caption         =   "ì¡ï ìoò^în"
   End
   Begin Umakichi.ctlClickLabel clblCmd 
      Height          =   225
      Index           =   2
      Left            =   2250
      TabIndex        =   8
      Top             =   1860
      Width           =   900
      _ExtentX        =   1588
      _ExtentY        =   397
      AutoSize        =   -1  'True
      BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "ÇlÇr ÇoÉSÉVÉbÉN"
         Size            =   11.25
         Charset         =   128
         Weight          =   400
         Underline       =   -1  'True
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   16711680
      Key             =   "Empty"
      ViewerName      =   "HCSel"
      Caption         =   "ç‚òHí≤ã≥"
   End
   Begin Umakichi.ctlClickLabel clblCmd 
      Height          =   225
      Index           =   3
      Left            =   570
      TabIndex        =   9
      Top             =   3150
      Width           =   675
      _ExtentX        =   1191
      _ExtentY        =   397
      AutoSize        =   -1  'True
      BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "ÇlÇr ÇoÉSÉVÉbÉN"
         Size            =   11.25
         Charset         =   128
         Weight          =   400
         Underline       =   -1  'True
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   16711680
      ViewerName      =   "Find"
      Caption         =   "ã£ëñîn"
   End
   Begin Umakichi.ctlClickLabel clblCmd 
      Height          =   225
      Index           =   4
      Left            =   570
      TabIndex        =   10
      Top             =   3510
      Width           =   450
      _ExtentX        =   794
      _ExtentY        =   397
      AutoSize        =   -1  'True
      BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "ÇlÇr ÇoÉSÉVÉbÉN"
         Size            =   11.25
         Charset         =   128
         Weight          =   400
         Underline       =   -1  'True
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   16711680
      Key             =   "1"
      ViewerName      =   "Find"
      Caption         =   "ãRéË"
   End
   Begin Umakichi.ctlClickLabel clblCmd 
      Height          =   225
      Index           =   5
      Left            =   570
      TabIndex        =   11
      Top             =   3870
      Width           =   675
      _ExtentX        =   1191
      _ExtentY        =   397
      AutoSize        =   -1  'True
      BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "ÇlÇr ÇoÉSÉVÉbÉN"
         Size            =   11.25
         Charset         =   128
         Weight          =   400
         Underline       =   -1  'True
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   16711680
      Key             =   "2"
      ViewerName      =   "Find"
      Caption         =   "í≤ã≥ét"
   End
   Begin Umakichi.ctlClickLabel clblCmd 
      Height          =   225
      Index           =   6
      Left            =   2250
      TabIndex        =   12
      Top             =   3150
      Width           =   450
      _ExtentX        =   794
      _ExtentY        =   397
      AutoSize        =   -1  'True
      BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "ÇlÇr ÇoÉSÉVÉbÉN"
         Size            =   11.25
         Charset         =   128
         Weight          =   400
         Underline       =   -1  'True
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   16711680
      Key             =   "3"
      ViewerName      =   "Find"
      Caption         =   "înéÂ"
   End
   Begin Umakichi.ctlClickLabel clblCmd 
      Height          =   225
      Index           =   7
      Left            =   2250
      TabIndex        =   13
      Top             =   3510
      Width           =   675
      _ExtentX        =   1191
      _ExtentY        =   397
      AutoSize        =   -1  'True
      BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "ÇlÇr ÇoÉSÉVÉbÉN"
         Size            =   11.25
         Charset         =   128
         Weight          =   400
         Underline       =   -1  'True
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   16711680
      Key             =   "4"
      ViewerName      =   "Find"
      Caption         =   "ê∂éYé“"
   End
   Begin Umakichi.ctlClickLabel clblCmd 
      Height          =   225
      Index           =   8
      Left            =   2250
      TabIndex        =   14
      Top             =   3870
      Width           =   675
      _ExtentX        =   1191
      _ExtentY        =   397
      AutoSize        =   -1  'True
      BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "ÇlÇr ÇoÉSÉVÉbÉN"
         Size            =   11.25
         Charset         =   128
         Weight          =   400
         Underline       =   -1  'True
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   16711680
      Key             =   "5"
      ViewerName      =   "Find"
      Caption         =   "î…êBîn"
   End
   Begin Umakichi.ctlClickLabel clblCmd 
      Height          =   225
      Index           =   9
      Left            =   2280
      TabIndex        =   15
      Top             =   1530
      Width           =   1350
      _ExtentX        =   2381
      _ExtentY        =   397
      AutoSize        =   -1  'True
      BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "ÇlÇr ÇoÉSÉVÉbÉN"
         Size            =   11.25
         Charset         =   128
         Weight          =   400
         Underline       =   -1  'True
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   16711680
      ViewerName      =   "RCSel"
      Caption         =   "ÉRÅ[ÉXÉåÉRÅ[Éh"
   End
   Begin VB.Menu mnuRight 
      Caption         =   "âEÉNÉäÉbÉN"
      Visible         =   0   'False
      Begin VB.Menu mnuNewWin 
         Caption         =   "êVÇµÇ¢ÉEÉCÉìÉhÉEÇ≈äJÇ≠"
         Index           =   0
      End
   End
End
Attribute VB_Name = "ctlVHome"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = True
Attribute VB_PredeclaredId = False
Attribute VB_Exposed = False
'
'   ÉzÅ[ÉÄâÊñ  ÉzÅ[ÉÄÉ{É^ÉìÇâüÇ∑Ç∆ÅAÇ±ÇÃâÊñ Ç™ï\é¶Ç≥ÇÍÇÈ
'   ÉfÉtÉHÉãÉgÇÃãNìÆéûâÊñ Ç‡Ç±ÇÃâÊñ Ç≈Ç†ÇÈ
'

Option Explicit

'---+----1----+----2----+----3----+----4----+----5----+----6----+----7----+----8
'   äOïîä÷êî(ÉCÉxÉìÉg)
'---+----1----+----2----+----3----+----4----+----5----+----6----+----7----+----8

Public Event ChangeTo(strViewerName As String, strKey As String)        '' ViererïœçXÉCÉxÉìÉg
Public Event LinkContextMenu(strViewerName As String, strKey As String) '' ÉäÉìÉNâEÉNÉäÉbÉNÉCÉxÉìÉg

'---+----1----+----2----+----3----+----4----+----5----+----6----+----7----+----8
'   ì‡ïîïœêî
'---+----1----+----2----+----3----+----4----+----5----+----6----+----7----+----8

Private mViewerState    As clsVSNothing         '' èÛë‘
Private mblnNoData As Boolean           '' ÉfÅ[É^ñ≥ÇµÉtÉâÉO

'---+----1----+----2----+----3----+----4----+----5----+----6----+----7----+----8
'   ÉvÉçÉpÉeÉB
'---+----1----+----2----+----3----+----4----+----5----+----6----+----7----+----8


'
'   ã@î\: ÉLÅ[ê›íËÉvÉçÉpÉeÉB
'
'   îıçl: ViewerïKê{ÉvÉçÉpÉeÉB
'
Public Property Let Key(strKey As String)
    ' Empty
End Property


'
'   ã@î\: ÉLÅ[éÊìæÉvÉçÉpÉeÉB
'
'   îıçl: ViewerïKê{ÉvÉçÉpÉeÉB
'
Public Property Get Key() As String
    ' Empty
End Property


'
'   ã@î\: É^ÉCÉgÉãéÊìæÉvÉçÉpÉeÉB
'
'   îıçl: ViewerïKê{ÉvÉçÉpÉeÉBÅAÅ@Browser Ç™åƒÇ—Ç‹Ç∑
'
Public Property Get Title() As String
    Title = "ÉzÅ[ÉÄ"
End Property


'
'   ã@î\: ViewerèÛë‘íÒãü
'
'   îıçl: Ç»Çµ
'
Public Property Get ViewerState() As clsVSNothing
    Set ViewerState = mViewerState
End Property


'
'   ã@î\: ViewerèÛë‘éÛÇØéÊÇË
'
'   îıçl: Ç»Çµ
'
Public Property Set ViewerState(RHS As clsVSNothing)
    Set mViewerState = RHS
End Property


'
'   ã@î\: ÉfÅ[É^ñ≥ÇµÇÉuÉâÉEÉUÇ…ì`Ç¶ÇÈ
'
'   îıçl:Å@ViewerïKê{ÉvÉçÉpÉeÉB
'
Public Property Get NoData() As Boolean
    NoData = mblnNoData
End Property


'---+----1----+----2----+----3----+----4----+----5----+----6----+----7----+----8
'   ì‡ïîä÷êî
'---+----1----+----2----+----3----+----4----+----5----+----6----+----7----+----8


'
'   ã@î\: âÊñ ïœçXÉCÉxÉìÉg
'
'   îıçl: ÉuÉâÉEÉUÇ…ÉCÉxÉìÉgÇÉXÉãÅ[Ç∑ÇÈ
'
Private Sub clblCmd_ChangeViewer(Index As Integer)
On Error GoTo ErrorHandler
    RaiseEvent ChangeTo(clblCmd(Index).ViewerName, clblCmd(Index).Key)
    Exit Sub
ErrorHandler:
    gApp.ErrLog
End Sub


'
'   ã@î\: âEÉNÉäÉbÉNâüâ∫ÉCÉxÉìÉg
'
'   îıçl: ÉuÉâÉEÉUÇÃÉ|ÉbÉvÉAÉbÉvÉCÉxÉìÉgÇ…ÉXÉãÅ[Ç∑ÇÈ
'
Private Sub clblCmd_RightMouseDown(Index As Integer)
On Error GoTo ErrorHandler
    RaiseEvent LinkContextMenu(clblCmd(Index).ViewerName, clblCmd(Index).Key)
    Exit Sub
ErrorHandler:
    gApp.ErrLog
End Sub


'
'   ã@î\: ÉÜÅ[ÉUÉRÉìÉgÉçÅ[Éãèâä˙âª
'
'   îıçl: Ç»Çµ
'
Private Sub UserControl_Initialize()
On Error GoTo ErrorHandler
    gApp.InitLog Me
    
    Dim i As Integer
    
    Set mViewerState = New clsVSNothing

    ' Color Assign
    BackColor = gApp.ColBG
    fraTop.BackColor = gApp.ColDarkBG
    For i = 0 To fraSub.UBound
        fraSub(i).BackColor = gApp.ColDarkBG
    Next i
    
    For i = lblFix.LBound To lblFix.UBound
        lblFix(i).BackColor = gApp.ColDarkBG
        lblFix(i).ForeColor = Contrast(gApp.ColDarkBG)
    Next i
    
    For i = clblCmd.LBound To clblCmd.UBound
        clblCmd(i).BackColor = gApp.ColBG
    Next i
    
    Exit Sub
ErrorHandler:
    gApp.ErrLog
End Sub


'
'   ã@î\: ÉÜÅ[ÉUÉRÉìÉgÉçÅ[ÉãÇÃÉ}ÉEÉXÉAÉbÉvÉCÉxÉìÉg
'
'   îıçl: Ç»Çµ
'
Private Sub UserControl_MouseUp(Button As Integer, Shift As Integer, X As Single, Y As Single)
On Error GoTo ErrorHandler
    Call UserControl.Parent.ShowPopupMenu(Button, Shift, X, Y)
    Exit Sub
ErrorHandler:
    gApp.ErrLog
End Sub


'
'   ã@î\: ÉÜÅ[ÉUÉRÉìÉgÉçÅ[ÉãÇÃÉäÉTÉCÉYÉCÉxÉìÉg
'
'   îıçl: Ç»Çµ
'
Private Sub UserControl_Resize()
On Error GoTo ErrorHandler
    With UserControl
        .width = Bigger(8000, .width)
        .Height = Bigger(5000, .Height)
    End With
    
    fraTop.width = ScaleWidth - fraTop.Left * 2
    fraSub(0).width = ScaleWidth - fraSub(0).Left * 2
    fraSub(1).width = ScaleWidth - fraSub(1).Left * 2
    Exit Sub
ErrorHandler:
    gApp.ErrLog
End Sub


'
'   ã@î\: ÉÜÅ[ÉUÉRÉìÉgÉçÅ[ÉãèIóπÉCÉxÉìÉg
'
'   îıçl: Ç»Çµ
'
Private Sub UserControl_Terminate()
On Error GoTo ErrorHandler
    gApp.TermLog Me
    
    Exit Sub
ErrorHandler:
    gApp.ErrLog
End Sub


'---+----1----+----2----+----3----+----4----+----5----+----6----+----7----+----8
'   äOïîä÷êî
'---+----1----+----2----+----3----+----4----+----5----+----6----+----7----+----8

'
'   ã@î\: èIóπèàóù
'
'   îıçl: Ç»Çµ
'
Public Sub Free()
End Sub

